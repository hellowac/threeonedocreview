(window["webpackJsonp_ThreeIntelligence"]=window["webpackJsonp_ThreeIntelligence"]||[]).push([["chunk-bbdba24c"],{"1e97":function(s,e,t){},8752:function(s){s.exports=JSON.parse("{}")},"8ee5":function(s,e,t){"use strict";t.r(e);var i=function(){var s=this,e=s._self._c;return e("div",{staticClass:"QA-assistant"},[e("div",{staticClass:"chat-gpt-left"},[e("div",{staticClass:"create-new-chat-button",on:{click:s.handleCreateNewChatSession}},[e("i",{staticClass:"el-icon-plus"}),s._v(" 新建对话框 ")]),e("div",{staticClass:"item-input"},[e("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"prefix-icon":"el-icon-search","fetch-suggestions":s.fetchSessionSuggestions,placeholder:"搜索..."},on:{select:s.handleSessionSelect},model:{value:s.inputSearchSessionKey,callback:function(e){s.inputSearchSessionKey=e},expression:"inputSearchSessionKey"}})],1),e("div",{staticClass:"item-input"},[e("el-button",{staticClass:"chat-history-title",attrs:{type:"text",disabled:""}},[s._v("会话历史")])],1),e("div",{staticClass:"item_c_list_content"},[e("div",{staticClass:"external-circulation"},[e("div",{staticClass:"inner-circulation"},s._l(s.sessionList,(function(t){return e("p",{key:t.id,staticClass:"item-p",class:{active:s.activeSessionId===t.id},on:{click:function(e){return s.handleSelectSession(t.id)}}},[e("i",{staticClass:"el-icon-chat-line-round"}),e("span",[e("span",[s._v(s._s(t.title))]),e("span",[s._v(s._s(t.create_at))])])])})),0)])])]),e("div",{staticClass:"chat-gpt-right"},[e("div",{ref:"messageContainer",staticClass:"chat-area"},[s._m(0),s._l(s.currentSessionMessages,(function(t){return e("div",{key:t.id,staticClass:"message"},[e("div",{staticClass:"message-bubble user-message"},[e("div",{staticClass:"c_cont"},[s._v(s._s(t.question))]),e("div",{staticClass:"c_name"},[s._v("我")])]),e("div",{staticClass:"message-bubble machine-response"},[e("div",{staticClass:"c_name"},[s._v("AI")]),e("div",{staticClass:"c_cont"},[s._v(s._s(t.answer))])])])}))],2),e("div",{staticClass:"input-area"},[e("div",[e("el-input",{attrs:{type:"textarea",placeholder:"来说些什么吧",disabled:s.isRobotReplying,rows:2},model:{value:s.inputMessage,callback:function(e){s.inputMessage=e},expression:"inputMessage"}}),e("el-button",{attrs:{type:"primary",loading:s.isRobotReplying},on:{click:s.sendMessage}},[s._v("发送")])],1)])])])},a=[function(){var s=this,e=s._self._c;return e("div",{staticClass:"message"},[e("div",{staticClass:"message-bubble machine-response"},[e("div",{staticClass:"c_name"},[s._v("AI")]),e("div",{staticClass:"c_cont"},[s._v("Hi, 我是智能审查助手，请问有什么可以帮助你？")])])])}],n=(t("14d9"),t("8752"),t("365c")),c=t("bcbf"),o={name:"QAassistant",data(){return{inputSearchSessionKey:"",inputMessage:"",sessionList:[{id:"0cacc9a0-75aa-4f61-9930-aede82d5ba5d",title:"新会话",create_at:"2025-06-15 20:34:14",update_at:"2025-06-15 20:34:14",is_delete:!1},{id:"851dc5a3-412f-4cd7-9462-7d88a6c1c2ac",title:"新会话",create_at:"2025-06-15 20:34:13",update_at:"2025-06-15 20:34:13",is_delete:!1}],currentSession:{id:Object(c["random"])(0,1e4),title:"最近对话",date:`今天${(new Date).getHours()}:${(new Date).getMinutes()}`},currentSessionMessages:[{question:"你是谁",id:"46459dbd-9627-4540-a117-5843359275f6",session_id:"9d372165-748a-4830-9b3f-65593a3d979a",answer:"这是AI的回答 for 你是谁",answer_at:null,create_at:"2025-06-15 21:15:36",update_at:"2025-06-15 21:15:36",is_delete:!1},{question:"你是谁2",id:"4ec21303-519f-4ef0-8b86-f10abb17631b",session_id:"9d372165-748a-4830-9b3f-65593a3d979a",answer:"这是AI的回答 for 你是谁2",answer_at:null,create_at:"2025-06-15 21:15:42",update_at:"2025-06-15 21:15:42",is_delete:!1}],activeSessionId:null,isRobotReplying:!1}},mounted(){this.fetchSessionsFromApi(),this.$nextTick(()=>{this.scrollToBottom()})},methods:{fetchSessionsFromApi(){Object(n["c"])("/chats/sessions/").then(s=>{console.log("总有会话数:",s.data.count),this.sessionList=s.data.data,this.sessionList.length>0&&this.handleSelectSession(this.sessionList[0].id)}).catch(s=>{this.$message.error("获取会话数据失败: "+s)})},handleOpenSearchDialog(){console.log("打开历史搜索dialog..."),this.isShowSearchDialog=!0},handleCreateNewChatSession(){console.log("新建会话session..."),Object(n["d"])("/chats/sessions/").then(s=>{const e=s.data;this.sessionList.unshift(e),this.inputMessage="",this.isRobotReplying=!1,this.handleSelectSession(e.id)}).catch(s=>{console.log("创建会话失败",s),this.$message.error("创建新会话失败: "+s)})},async fetchSessionSuggestions(s,e){if(console.log("获取搜索会话的建议..."),s)try{const t={key:s},i=await Object(n["c"])("/chats/sessions/search",t),a=i.data.data.map(s=>({id:s.id,value:s.title}));e(a)}catch(t){console.error("搜索失败:",t),e([])}else e([])},handleSessionSelect(s){console.log("会话session选中:",s);const e=s.id;this.handleSelectSession(e)},handleSelectSession(s){console.log("选择会话: ",s),this.currentSession=this.sessionList.find(e=>e.id===s),this.activeSessionId=s,console.log("选择会话的对话记录: ",s),Object(n["c"])(`/${s}/chats/`).then(s=>{console.log(`获取[${this.currentSession.title}]共有${s.data.count}条记录！`),this.currentSessionMessages=s.data.data,this.$nextTick(()=>{this.scrollToBottom()})}).catch(s=>{this.$message.error(`获取[${this.currentSession.title}]的对话记录失败`)})},async sendMessage(){this.isRobotReplying=!0;const s={question:this.inputMessage};Object(n["d"])(`/${this.currentSession.id}/chats/`,s).then(s=>{this.currentSessionMessages.push(s.data),console.log("发送提问完成!"),this.inputMessage="",this.isRobotReplying=!1,this.$nextTick(()=>{this.scrollToBottom()})}).catch(s=>{console.log("发送问题失败:",s),this.$message.error("发送问题失败: "+s)})},delay(s){return new Promise(e=>setTimeout(e,s))},scrollToBottom(){const s=this.$refs.messageContainer;s&&(s.scrollTop=s.scrollHeight)}}},l=o,r=(t("e758"),t("2877")),d=Object(r["a"])(l,i,a,!1,null,"49ef7c46",null);e["default"]=d.exports},e758:function(s,e,t){"use strict";t("1e97")}}]);