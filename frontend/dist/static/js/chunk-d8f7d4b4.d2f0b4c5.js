(window["webpackJsonp_ThreeIntelligence"]=window["webpackJsonp_ThreeIntelligence"]||[]).push([["chunk-d8f7d4b4"],{"01d5":function(e,t,a){"use strict";a.r(t);var n=function(){var e=this,t=e._self._c;return t("div",{staticClass:"onlineTool"},[t("el-tabs",{model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"AI接口调试",name:"agentdebug"}},[t("agentdebug")],1),t("el-tab-pane",{attrs:{label:"文件解析",name:"fileparse"}},[t("fileParse")],1)],1)],1)},i=[],l=a("365c"),r=a("bcbf"),s=function(){var e=this,t=e._self._c;return t("div",{staticClass:"QA-assistant"},[t("div",{staticClass:"chat-gpt-left"},[t("el-upload",{staticClass:"create-new-chat-button",attrs:{action:"#","show-file-list":!1,"auto-upload":!1,"file-list":e.docxFileList,accept:"application/vnd.openxmlformats-officedocument.wordprocessingml.document","on-change":e.handleUploadDoxFile}},[t("span",{staticStyle:{color:"#fff"}},[t("i",{staticClass:"el-icon-upload"}),e._v("选择文件(.docx)")])]),t("div",{staticClass:"item-input"},[t("el-autocomplete",{staticStyle:{width:"100%"},attrs:{"prefix-icon":"el-icon-search",clearable:"","fetch-suggestions":e.fetchFilesSuggestions,placeholder:"搜索..."},on:{select:e.handleFilesSelect},model:{value:e.inputSearchFilenameKey,callback:function(t){e.inputSearchFilenameKey=t},expression:"inputSearchFilenameKey"}})],1),t("div",{staticClass:"item-input"},[t("el-button",{staticClass:"chat-history-title",attrs:{type:"text",disabled:""}},[e._v("解析历史")])],1),t("div",{staticClass:"item_c_list_content"},[t("div",{staticClass:"external-circulation"},[t("div",{staticClass:"inner-circulation"},e._l(e.filesList,(function(a){return t("p",{key:a.id,staticClass:"item-p",class:{active:e.activeFileId===a.id},on:{click:function(t){return e.handleSelectDocxFile(a.id)}}},[t("i",{staticClass:"el-icon-document"}),t("span",[t("span",[e._v(e._s(a.file_name))]),t("span",[e._v(e._s(a.create_at))])])])})),0)])])],1),t("div",{staticClass:"chat-gpt-right"},[t("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-between"}},[t("el-col",{attrs:{span:6}},[t("el-radio-group",{on:{input:e.handleFIleContentTypeInput},model:{value:e.fileContentType,callback:function(t){e.fileContentType=t},expression:"fileContentType"}},[t("el-radio-button",{attrs:{label:"txt"}},[e._v("text")]),t("el-radio-button",{attrs:{label:"html"}}),t("el-radio-button",{attrs:{label:"markdown"}})],1)],1),t("el-col",{attrs:{span:6}},[t("el-button",{staticStyle:{float:"right"},attrs:{size:"small"},on:{click:e.hanleDownloadFileContent}},[e._v("下载")]),t("br")],1)],1),t("div",{ref:"messageContainer",staticClass:"chat-area"},["html"===e.fileContentType?t("div",{domProps:{innerHTML:e._s(e.currentFileContent.html_content)}}):"txt"===e.fileContentType?t("div",[t("pre",[e._v("                    "+e._s(e.currentFileContent.txt_content)+"\n                ")])]):t("div",[t("pre",[e._v("                    "+e._s(e.currentFileContent.md_content)+"\n                ")])])])],1)])},o=[],c=(a("88a7"),a("271a"),a("5494"),{name:"fileParse",data(){return{docxFileList:[],fileContentType:"html",inputSearchFilenameKey:"",filesList:[{id:"0cacc9a0-75aa-4f61-9930-aede82d5ba5d",file_name:"xxxx.docx",create_at:"2025-06-15 20:34:14",update_at:"2025-06-15 20:34:14",is_delete:!1},{id:"851dc5a3-412f-4cd7-9462-7d88a6c1c2ac",file_name:"xxxx三措.docx",create_at:"2025-06-15 20:34:13",update_at:"2025-06-15 20:34:13",is_delete:!1}],currentFile:{id:Object(r["random"])(0,1e4),title:"最近对话",date:`今天${(new Date).getHours()}:${(new Date).getMinutes()}`},currentFileContent:{html_content:"",txt_content:"",md_content:""},activeFileId:null,isRobotReplying:!1}},mounted(){this.fetchDocxHistoryFromApi()},methods:{handleFIleContentTypeInput(e){console.log("选择的文件内容格式:",e)},hanleDownloadFileContent(){console.log("选择下载的文件内容格式:",this.fileContentType),this.downloadFileContent()},downloadFileContent(){const e=this.currentFileContent.txt_content,t="text/plain",a=this.currentFile.file_name+".txt";"html"===this.fileContentType?(e=this.currentFileContent.html_content,t="text/html",a=this.currentFile.file_name+".html"):"markdown"==this.fileContentType&&(e=this.currentFileContent.md_content,t="text/markdown",a=this.currentFile.file_name+".md");const n=new Blob([e],{type:t}),i=URL.createObjectURL(n),l=document.createElement("a");l.href=i,l.download=a,document.body.appendChild(l),l.click(),document.body.removeChild(l),URL.revokeObjectURL(i)},async handleUploadDoxFile(e,t){const a=new FormData;a.append("docx_file",e.raw);try{await Object(l["a"])("/tool/parse/files","post",a);this.$message.success("上传成功"),this.docxFileList=[],this.fetchDocxHistoryFromApi()}catch(n){this.$message.error("上传失败"),console.error(n)}},fetchDocxHistoryFromApi(){Object(l["c"])("/tool/parse/files").then(e=>{console.log("共有文件数:",e.data.count),this.filesList=e.data.data,this.filesList.length>0&&this.handleSelectDocxFile(this.filesList[0].id)}).catch(e=>{this.$message.error("获取文件历史数据失败: "+e)})},async fetchFilesSuggestions(e,t){if(console.log("获取搜索会话的建议..."),e)try{const a={key:e},n=await Object(l["c"])("/tool/parse/files/search",a),i=n.data.data.map(e=>({id:e.id,value:e.file_name}));t(i)}catch(a){console.error("搜索失败:",a),t([])}else t([])},handleFilesSelect(e){console.log("文件历史选中:",e);const t=e.id;this.handleSelectDocxFile(t)},handleSelectDocxFile(e){console.log("选择文件: ",e),this.currentFile=this.filesList.find(t=>t.id===e),this.activeFileId=e,console.log("选择文件的内容: ",e),Object(l["c"])("/tool/parse/files/"+e).then(e=>{console.log(`获取[${this.currentFile.file_name}]的文件内容`),this.currentFileContent=e.data}).catch(e=>{this.$message.error(`获取[${this.currentFile.file_name}]的文件内容失败`)})}}}),d=c,p=(a("216d"),a("2877")),u=Object(p["a"])(d,s,o,!1,null,"1fa2ea34",null),_=u.exports,m=function(){var e=this,t=e._self._c;return t("div",{staticClass:"agentdebug"},[t("el-form",{ref:"form",attrs:{model:e.form,"label-width":"80px"}},[t("el-form-item",{attrs:{label:"选择类型"}},[t("el-select",{attrs:{placeholder:"选择类型"},on:{change:e.fetchAiApis},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[t("el-option",{attrs:{label:"输电",value:"输电"}}),t("el-option",{attrs:{label:"变电",value:"变电"}}),t("el-option",{attrs:{label:"配电",value:"配电"}}),t("el-option",{attrs:{label:"智能助手",value:"智能助手"}})],1)],1),t("el-form-item",{attrs:{label:"选择配置",required:""}},[t("el-select",{attrs:{placeholder:"选择配置"},model:{value:e.form.setting_id,callback:function(t){e.$set(e.form,"setting_id",t)},expression:"form.setting_id"}},e._l(e.aiApis,(function(e){return t("el-option",{attrs:{label:e.section,value:e.id}})})),1)],1),t("el-form-item",{attrs:{label:"对话内容",required:""}},[t("el-input",{staticStyle:{width:"80%"},attrs:{type:"textarea",placeholder:"发送给AI的内容",rows:"4"},model:{value:e.form.content,callback:function(t){e.$set(e.form,"content",t)},expression:"form.content"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary",disalbed:e.loading},on:{click:e.onSubmit}},[e._v("提交")])],1)],1),t("el-tabs",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],attrs:{type:"border-card","element-loading-text":"拼命加载中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.4)"},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[t("el-tab-pane",{attrs:{label:"配置信息",name:"config"}},[t("div",[e._v("节: "+e._s(e.currentRecord.section))]),t("div",[e._v("主机: "+e._s(e.currentRecord.host))]),t("div",[e._v("端口: "+e._s(e.currentRecord.port))]),t("div",[e._v("应用KEY: "+e._s(e.currentRecord.app_key))]),t("div",[e._v("智能体编码: "+e._s(e.currentRecord.agent_code))]),t("div",[e._v("智能体版本: "+e._s(e.currentRecord.agent_version))]),t("div",[e._v("会话ID(已删除): "+e._s(e.currentRecord.session_id))])]),t("el-tab-pane",{attrs:{label:"请求内容",name:"request"}},[t("div",[e._v("POST: "+e._s(e.currentRecord.req_url))]),t("div",[e._v("开始于: "+e._s(e.currentRecord.req_begin_at))]),t("div",[e._v("结束于: "+e._s(e.currentRecord.resp_done_at))]),t("div",[e._v("耗时: "+e._s(e.currentRecord.resp_spend)+"(秒)")]),t("el-collapse",{model:{value:e.reqActiveName,callback:function(t){e.reqActiveName=t},expression:"reqActiveName"}},[t("el-collapse-item",{attrs:{title:"请求Header",name:"header",disabled:""}},[t("pre",[e._v(e._s(e.currentRecord.req_header))])]),t("el-collapse-item",{attrs:{title:"请求Payload",name:"payload",disabled:""}},[t("pre",[e._v(e._s(e.currentRecord.req_payload))])])],1)],1),t("el-tab-pane",{attrs:{label:"响应内容",name:"response"}},[t("div",[e._v("状态码: "+e._s(e.currentRecord.resp_status))]),t("div",[e._v("开始于: "+e._s(e.currentRecord.req_begin_at))]),t("div",[e._v("结束于: "+e._s(e.currentRecord.resp_done_at))]),t("div",[e._v("耗时: "+e._s(e.currentRecord.resp_spend)+"(秒)")]),t("el-collapse",{model:{value:e.respActiveName,callback:function(t){e.respActiveName=t},expression:"respActiveName"}},[t("el-collapse-item",{attrs:{title:"响应Header",name:"header",disabled:""}},[t("pre",[e._v(e._s(e.currentRecord.req_header))])]),t("el-collapse-item",{attrs:{title:"响应内容",name:"content",disabled:""}},[t("pre",[e._v(e._s(e.currentRecord.req_payload))])])],1)],1),null===e.currentRecord.error_traceback?t("el-tab-pane",{attrs:{label:"文本结果",name:"text"}},[t("pre",[e._v(e._s(e.currentRecord.resp_res_text||""))])]):e._e(),null===e.currentRecord.error_traceback?t("el-tab-pane",{attrs:{label:"JSON结果",name:"json"}},[t("pre",[e._v(e._s(e.currentRecord.resp_res_json||""))])]):e._e(),null!==e.currentRecord.error_traceback?t("el-tab-pane",{staticStyle:{color:"red"},attrs:{label:"错误信息",name:"error"}},[t("pre",[e._v(e._s(e.currentRecord.error_traceback||""))])]):e._e()],1),t("h4",[e._v("调试记录")]),t("el-table",{attrs:{data:e.historyRecords}},[t("el-table-column",{attrs:{prop:"id",label:"序号"}}),t("el-table-column",{attrs:{prop:"create_at",label:"时间"}}),t("el-table-column",{attrs:{prop:"agent_type",label:"专业"}}),t("el-table-column",{attrs:{prop:"section",label:"配置"}}),t("el-table-column",{attrs:{prop:"resp_status",label:"状态码"}}),t("el-table-column",{attrs:{label:"操作"},scopedSlots:e._u([{key:"default",fn:function(a){return[t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleDetail(a.row)}}},[e._v("详情")]),t("el-button",{attrs:{type:"text",size:"small"},on:{click:function(t){return e.handleDelete(a.row)}}},[e._v("删除")])]}}])})],1),t("Pagination",{staticClass:"module-page",attrs:{limit:e.pageLimit,total:e.tableDataTotal},on:{"update:limit":function(t){e.pageLimit=t},"update:total":function(t){e.tableDataTotal=t},pagination:e.handlePagination}}),t("el-dialog",{attrs:{visible:e.showDetailDialog},on:{"update:visible":function(t){e.showDetailDialog=t}}},[t("el-tabs",{model:{value:e.detailActiveName,callback:function(t){e.detailActiveName=t},expression:"detailActiveName"}},[t("el-tab-pane",{attrs:{label:"配置信息",name:"config"}},[t("div",[e._v("节: "+e._s(e.detailRecord.section))]),t("div",[e._v("主机: "+e._s(e.detailRecord.host))]),t("div",[e._v("端口: "+e._s(e.detailRecord.port))]),t("div",[e._v("应用KEY: "+e._s(e.detailRecord.app_key))]),t("div",[e._v("智能体编码: "+e._s(e.detailRecord.agent_code))]),t("div",[e._v("智能体版本: "+e._s(e.detailRecord.agent_version))]),t("div",[e._v("会话ID(已删除): "+e._s(e.detailRecord.session_id))])]),t("el-tab-pane",{attrs:{label:"请求内容",name:"request"}},[t("div",[e._v("POST: "+e._s(e.detailRecord.req_url))]),t("div",[e._v("开始于: "+e._s(e.detailRecord.req_begin_at))]),t("div",[e._v("结束于: "+e._s(e.detailRecord.resp_done_at))]),t("div",[e._v("耗时: "+e._s(e.detailRecord.resp_spend)+"(秒)")]),t("el-collapse",{model:{value:e.reqActiveName,callback:function(t){e.reqActiveName=t},expression:"reqActiveName"}},[t("el-collapse-item",{attrs:{title:"请求Header",name:"header",disabled:""}},[t("pre",[e._v(e._s(e.detailRecord.req_header))])]),t("el-collapse-item",{attrs:{title:"请求Payload",name:"payload",disabled:""}},[t("pre",[e._v(e._s(e.detailRecord.req_payload))])])],1)],1),t("el-tab-pane",{attrs:{label:"响应内容",name:"response"}},[t("div",[e._v("状态码: "+e._s(e.detailRecord.resp_status))]),t("div",[e._v("开始于: "+e._s(e.detailRecord.req_begin_at))]),t("div",[e._v("结束于: "+e._s(e.detailRecord.resp_done_at))]),t("div",[e._v("耗时: "+e._s(e.detailRecord.resp_spend)+"(秒)")]),t("el-collapse",{model:{value:e.respActiveName,callback:function(t){e.respActiveName=t},expression:"respActiveName"}},[t("el-collapse-item",{attrs:{title:"响应Header",name:"header",disabled:""}},[t("pre",[e._v(e._s(e.detailRecord.req_header))])]),t("el-collapse-item",{attrs:{title:"响应内容",name:"content",disabled:""}},[t("pre",[e._v(e._s(e.detailRecord.req_payload))])])],1)],1),null===e.detailRecord.error_traceback?t("el-tab-pane",{attrs:{label:"文本结果",name:"text"}},[t("pre",[e._v(e._s(e.detailRecord.resp_res_text||""))])]):e._e(),null===e.detailRecord.error_traceback?t("el-tab-pane",{attrs:{label:"JSON结果",name:"json"}},[t("pre",[e._v(e._s(e.detailRecord.resp_res_json||""))])]):e._e(),null!==e.detailRecord.error_traceback?t("el-tab-pane",{staticStyle:{color:"red"},attrs:{label:"错误信息",name:"error"}},[t("pre",[e._v(e._s(e.detailRecord.error_traceback||""))])]):e._e()],1)],1)],1)},h=[],v={name:"agentdebug",data(){return{loading:!1,activeName:"request",form:{type:"输电",setting_id:void 0,content:""},reqActiveName:["header","payload"],respActiveName:["header","content"],aiApis:[],currentRecord:{host:"localhost",req_begin_at:"2025-08-13 16:59:00",resp_text:'{\n  "success": true,\n  "da....',port:8002,req_url:"http://localhost:8002/xlm-gateway-bo-ihi/sfm-api-gateway/gateway/agent/api/run",resp_res_text:'\n\n```json\n[\n  {\n    "catalog_name": "工程概况",\n    "question": "缺失地理位置信息：内容未明确工程所在的地市/区、县、乡镇/街道及周边重点参照物（如道路、建筑等）。",\n    "question_tag": "内容缺失",\n    "question_exist": "true",\n    "feedback": "补充工程地理位置，例如“本工程位于XX市XX区XX街道，邻近XX变电站/XX道路，涉及拆除同塔双回线路导、地线共XX公里”。",\n    "feedback_exist": "true",\n    "feedback_tag": "补充内容",\n    "filename": "无支撑材料。",\n    "content": "无支撑材料。",\n    "ai_error": ""\n  },\n  {\n   ... 料。",\n    "ai_error": ""\n  }\n]\n```',app_key:"jm77cyhyp4isp095skx85q1mcjs0rsf6",req_header:'{\n  "Authorization": "Bearer jm77cyhyp4isp095skx85q1mcjs0rsf6",\n  "Content-Type": "application/json"\n}',resp_res_json:"[\n  ....",create_at:"2025-08-13 16:59:00",agent_code:"agent1",req_payload:'{\n  "sessionId": "c1b5e481-6057-4016-8213-b74e49971d94",\n  "stream": false,\n  "delta": true,\n  "trace": false,\n  "message": {\n    "text": "adf",\n    "metadata": {},\n    "attachments": []\n  }\n}',resp_can_validate:!0,update_at:"2025-08-13 16:59:00",agent_version:"agent1",resp_done_at:"2025-08-13 16:59:00",error_traceback:null,is_delete:!1,session_id:"c1b5e481-6057-4016-8213-b74e49971d94",resp_status:200,id:29,agent_type:"输电",resp_spend:.02,protocol:"http",section:"第五节",resp_header:'{\n  "Connection": "close",\n  "Content-Length": "4442",\n  "Content-Type": "application/json",\n  "Date": "Wed, 13 Aug 2025 08:58:59 GMT",\n  "Server": "uvicorn"\n}'},historyRecords:[],pageLimit:10,tableDataTotal:10,querySkip:0,queryLimit:10,detailRecord:{},showDetailDialog:!1,detailActiveName:"request"}},mounted(){this.fetchAiApis("输电"),this.fetchDebugHistoryRecords()},methods:{fetchAiApis(e){console.log("获取专业接口列表"),Object(l["c"])("/agentsettings/"+e).then(e=>{this.aiApis=e.data.data,this.form.setting_id=void 0})},fetchDebugHistoryRecords(e){console.log("获取历史调试记录"),Object(l["c"])("/agentsettings/debug/records",{skip:this.querySkip,limit:this.queryLimit}).then(e=>{this.historyRecords=e.data.data,this.tableDataTotal=e.data.count})},handlePagination(e){console.log("处理分页:",e),this.querySkip=e.page>1?(e.page-1)*e.limit:0,this.queryLimit=e.limit,this.fetchDebugHistoryRecords()},onSubmit(){console.log("调试agent接口"),this.form.setting_id&&this.form.content?(this.loading=!0,Object(l["d"])(`/agentsettings/${this.form.setting_id}/debug`,this.form).then(e=>{this.currentRecord=e.data,this.loading=!1,this.fetchDebugHistoryRecords()})):this.$message.warning("请选择配置或输入内容")},handleDetail(e){console.log("查看详情",e),this.detailRecord=e,this.showDetailDialog=!0},handleDelete(e){console.log("删除调试记录",e),this.$confirm("此操作将永久删除该调试记录, 是否继续?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{Object(l["d"])(`/agentsettings/debug/record/${e.id}/delete`).then(e=>{this.$message({type:"success",message:"删除成功!"}),this.fetchDebugHistoryRecords()})}).catch(()=>{this.$message({type:"info",message:"已取消删除"})})}}},b=v,f=(a("11a0"),Object(p["a"])(b,m,h,!1,null,"5af658b4",null)),g=f.exports,y={name:"QAassistant",components:{fileParse:_,agentdebug:g},data(){return{activeName:"agentdebug"}},mounted(){},methods:{}},x=y,R=(a("65d3"),Object(p["a"])(x,n,i,!1,null,"95428afe",null));t["default"]=R.exports},"11a0":function(e,t,a){"use strict";a("a43b")},"216d":function(e,t,a){"use strict";a("c26c")},"271a":function(e,t,a){"use strict";var n=a("cb2d"),i=a("e330"),l=a("577e"),r=a("d6d6"),s=URLSearchParams,o=s.prototype,c=i(o.getAll),d=i(o.has),p=new s("a=1");!p.has("a",2)&&p.has("a",void 0)||n(o,"has",(function(e){var t=arguments.length,a=t<2?void 0:arguments[1];if(t&&void 0===a)return d(this,e);var n=c(this,e);r(t,1);var i=l(a),s=0;while(s<n.length)if(n[s++]===i)return!0;return!1}),{enumerable:!0,unsafe:!0})},5252:function(e,t,a){},5494:function(e,t,a){"use strict";var n=a("83ab"),i=a("e330"),l=a("edd0"),r=URLSearchParams.prototype,s=i(r.forEach);n&&!("size"in r)&&l(r,"size",{get:function(){var e=0;return s(this,(function(){e++})),e},configurable:!0,enumerable:!0})},"65d3":function(e,t,a){"use strict";a("5252")},"88a7":function(e,t,a){"use strict";var n=a("cb2d"),i=a("e330"),l=a("577e"),r=a("d6d6"),s=URLSearchParams,o=s.prototype,c=i(o.append),d=i(o["delete"]),p=i(o.forEach),u=i([].push),_=new s("a=1&a=2&b=3");_["delete"]("a",1),_["delete"]("b",void 0),_+""!=="a=2"&&n(o,"delete",(function(e){var t=arguments.length,a=t<2?void 0:arguments[1];if(t&&void 0===a)return d(this,e);var n=[];p(this,(function(e,t){u(n,{key:t,value:e})})),r(t,1);var i,s=l(e),o=l(a),_=0,m=0,h=!1,v=n.length;while(_<v)i=n[_++],h||i.key===s?(h=!0,d(this,i.key)):m++;while(m<v)i=n[m++],i.key===s&&i.value===o||c(this,i.key,i.value)}),{enumerable:!0,unsafe:!0})},a43b:function(e,t,a){},c26c:function(e,t,a){},d6d6:function(e,t,a){"use strict";var n=TypeError;e.exports=function(e,t){if(e<t)throw new n("Not enough arguments");return e}}}]);